---
title: "[2026 동계 모각코] 2026-01-16 결과 (5회차)"
image: "/images/mogakco_11.png"
date: "2026-01-16"
category: "mogakco"
tags: ["모각코"]
summary: ""
draft: false
---

## 목표
- 목표: 시나리오 데이터 제작 및 구현한 도구를 사용한 분석 수행
- 진행 내용
    - 테스트 시나리오 제작
    - 리포트에 들어갈 해석 포인트 정리
        - 다운로드 시간대, URL 체인, 저장 경로(Downloads/Temp), 파일 유형, 중단/실패 이유, 위험 태그 의미

## 진행 내용

### 테스트 시나리오 소개

[2023 KDFS(Korea Digital Forensics Society) 디지털 포렌식 경진대회](https://plainbit.co.kr/events/kdfs2023/) 문제를 활용하여 시나리오 상황을 시뮬레이션했다.

**상황 설정**:

> 평소 주식 투자를 즐겨하던 프로그래머 출신 김영끌은 최근 코인 투자를 시작했다. 코인 투자에 대한 지식이 없는 상태에서 주식 투자 경험만 믿고 공격적인 투자를 지속한 결과 큰 자금 손실을 경험하게 되었다. 이를 비관한 김영끌은 감정에 치우쳐 코인 관련 커뮤니티에 범죄 예고 글을 게시하였다.
>
> 사이버 수사관은 김영끌이 올린 범죄 예고 글을 신고 받고 김영끌의 집을 압수수색하였다. 수사관은 김영끌의 PC를 이미징하고 현장 조사하는 과정에서 **랜섬웨어 범죄와 관련한 정황**을 추가로 확인해 별건 수사를 진행하게 되었다.

**분석 대상**: Chrome History DB (13개 다운로드 기록)

**분석 목표**:
- 김영끌의 투자 활동 관련 증거 확인
- 랜섬웨어 범죄 관련 정황 파악
- 추가 공모자 존재 여부 확인

#### 시나리오 실행

```bash
cd C:\Users\sjna\문서\Project\download-triage
python main.py C:\Users\sjna\Desktop\History
```

#### 분석 결과 요약

도구 실행 결과, 다음과 같은 위험도 분포가 확인되었다.

| 위험도 | 개수 | 비율 |
|--------|------|------|
| Critical | 7 | 53.8% |
| High | 0 | 0% |
| Medium | 1 | 7.7% |
| Low | 0 | 0% |
| Safe | 5 | 38.5% |

![분석 결과 레코드 목록](/images/mogakco_11.png)

![Risk Summary](/images/mogakco_12.png)

#### 다운로드 기록 타임라인

| 날짜 | 파일명 | 분류 | 의미 |
|------|--------|------|------|
| 2023-09-13 | `python-3.11.5-amd64.exe` | 개발 도구 | Python 설치 |
| 2023-09-13 | `Sublime Text Build 3211 x64 Setup.exe` | 개발 도구 | 텍스트 에디터 설치 |
| 2023-09-13 | `eFriendPlus_setup.exe` | 금융 | 한국투자증권 HTS (주식 거래) |
| 2023-09-14 | `DiscordSetup.exe` | 커뮤니케이션 | Discord 설치 |
| 2023-09-14 | 매매일지 관련 xlsx 5개 | 투자 기록 | 주식/코인 매매일지 양식 |
| 2023-09-15 | `GitHubDesktopSetup-x64.exe` | 개발 도구 | GitHub Desktop 설치 |
| 2023-09-15 | `BlockstreamGreen_Windows_x86_64.zip` | 암호화폐 | 비트코인 지갑 |
| 2023-09-17 | `ledger-live-desktop-2.68.1-win-x64.exe` | 암호화폐 | Ledger 하드웨어 지갑 SW |

#### Critical 파일 상세 분석

| 파일명 | 위험 사유 | 분석 소견 |
|--------|----------|----------|
| `ledger-live-desktop-2.68.1-win-x64.exe` | 위험 확장자(.exe) | Ledger 하드웨어 지갑 관리 SW. **암호화폐 보유 증거** |
| `ledger-live-desktop-2.68.1-win-x64 (1).exe` | 위험 확장자(.exe) | 동일 파일 재다운로드 후 **취소됨**. 설치 문제 발생 추정 |
| `GitHubDesktopSetup-x64.exe` | 위험 확장자(.exe), 의심 키워드(setup) | GitHub Desktop. **코드 관리/공유 가능성** |
| `DiscordSetup.exe` | 위험 확장자(.exe), 의심 키워드(setup) | Discord. **커뮤니티 활동 또는 공모자 연락 수단** |
| `eFriendPlus_setup.exe` | 위험 확장자(.exe), 의심 키워드(setup) | 한국투자증권 HTS. 주식 투자 활동 증거 |
| `Sublime Text Build 3211 x64 Setup.exe` | 위험 확장자(.exe), 의심 키워드(setup) | 텍스트 에디터. **코드 작성 도구** |
| `python-3.11.5-amd64.exe` | 위험 확장자(.exe) | Python 인터프리터. **랜섬웨어 개발 가능성** |

#### 시나리오 관점 분석

**1. 투자 활동 증거**
- `eFriendPlus_setup.exe`: 한국투자증권 HTS → 주식 투자 활동 확인
- 매매일지 xlsx 파일 5개: 여러 블로그에서 매매일지 양식 다운로드 → 투자 기록 관리 시도
- `ledger-live-desktop`, `BlockstreamGreen`: 암호화폐 지갑 SW → 코인 투자 전환 확인

**2. 랜섬웨어 개발 정황**
- `python-3.11.5-amd64.exe`: 랜섬웨어 개발에 자주 사용되는 언어
- `Sublime Text`: 코드 작성 도구
- `GitHubDesktopSetup-x64.exe`: 코드 버전 관리 및 공유

**3. 공모자 연락 가능성**
- `DiscordSetup.exe`: 익명 커뮤니케이션 도구, 범죄 조직 연락 수단으로 활용 가능

#### 실제 분석 보고서와 비교

KDFS 2023 공식 분석 보고서와 비교한 결과, download-triage 도구가 올바르게 식별한 항목은 다음과 같다.

| 도구 탐지 결과 | 실제 분석 결과 |
|--------------|--------------|
| Python, Sublime Text, GitHub Desktop → 개발 도구 조합 | 랜섬웨어(`ransom.exe`)가 **Python 3.10**으로 개발된 것 확인 |
| Ledger Live, Blockstream Green → 암호화폐 지갑 | 피해자로부터 받은 **0.009 BTC** 수취 및 공범에게 **0.0085 wBTC** 송금에 사용 |
| Discord → 커뮤니케이션 도구 | 공범 **CyberNinja__**와 랜섬웨어 유포 협의에 사용 |
| eFriendPlus (HTS) → 투자 활동 | 투자 실패로 인한 금전적 압박이 **범죄 동기**로 확인 |

> 다운로드 기록 분석을 통해 개발 도구, 암호화폐 지갑, 커뮤니케이션 도구의 설치 여부를 파악할 수 있었고, 이를 바탕으로 각 아티팩트(Discord 캐시, 이메일, 지갑 데이터 등)에 대한 심층 분석 방향을 설정할 수 있었다. 이는 초기 트리아지 단계에서 History DB 확인이 분석 방향 설정에 효과적임을 보여준다.

### 리포트에 들어갈 해석 포인트 정리

트리아지 리포트 작성 시 분석가가 확인해야 할 핵심 해석 포인트를 정리했다.

#### 1. 다운로드 시간대 분석

- **짧은 시간 내 대량 다운로드**: 몇 분 내에 여러 파일이 다운로드된 경우 드라이브 바이 다운로드 의심
- **패턴 분석**: 주기적인 다운로드는 C2 통신이나 업데이트 체크일 수 있음

```
분석 포인트:
- Start/End 시간 차이가 비정상적으로 짧거나 긴 경우 확인
- 동일 시간대에 여러 파일이 다운로드된 경우 연관성 분석
```

#### 2. URL 체인 분석

- **리다이렉션 체인**: `downloads_url_chains` 테이블에서 여러 URL이 연결된 경우
- **단축 URL**: bit.ly, tinyurl 등을 통한 다운로드는 원본 URL 은닉 시도
- **IP 직접 접속**: 도메인 없이 IP로 직접 접속한 경우 C2 서버 가능성

```
분석 포인트:
- chain_index가 0보다 큰 레코드 존재 여부 확인
- 최초 URL과 최종 URL의 도메인이 다른 경우 주의
```

#### 3. 저장 경로 분석

| 경로 | 의미 | 위험도 |
|------|------|--------|
| `Downloads` | 사용자가 의도적으로 다운로드 | 낮음 |
| `Temp`, `AppData\Local\Temp` | 임시 파일, 브라우저 자동 다운로드 | 중간 |
| `AppData\Roaming` | 사용자 데이터 영역, 악성코드가 선호 | 높음 |
| `ProgramData` | 시스템 전역 데이터, 권한 상승 시도 가능 | 높음 |

#### 4. 중단/실패 이유 해석

| State | 의미 | 분석 포인트 |
|-------|------|-------------|
| 0 (In Progress) | 다운로드 진행 중 | DB 스냅샷 시점에 진행 중이던 파일 |
| 1 (Complete) | 정상 완료 | 파일이 실제로 존재하는지 확인 필요 |
| 2 (Cancelled) | 사용자 취소 | 의도적 취소인지, 보안 소프트웨어 차단인지 확인 |
| 3 (Interrupted) | 네트워크 오류 등으로 중단 | 악성 서버 다운 또는 보안 장비 차단 가능성 |

## 회고

- KDFS 2023 시나리오를 분석하면서 도구의 트리아지 결과가 분석 방향 설정에 활용될 수 있음을 확인했다.
- `downloads_url_chains` 테이블을 활용한 리다이렉션 체인 분석은 단축 URL이나 피싱 사이트 탐지에 유용할 것으로 보인다. 향후 이 부분을 리포트에 포함시킬 예정이다.
